<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TradingView Widget with Price Level</title>
</head>
<body>
<!-- TradingView Widget BEGIN -->
<div class="tradingview-widget-container" style="height:100%;width:100%">
  <div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div>
  <div class="tradingview-widget-copyright"><a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank"><span class="blue-text">Track all markets on TradingView</span></a></div>
  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
    {
      "autosize": true,
      "symbol": "NASDAQ:AAPL",
      "interval": "D",
      "timezone": "Etc/UTC",
      "theme": "light",
      "style": "1",
      "locale": "en",
      "allow_symbol_change": true,
      "support_host": "https://www.tradingview.com"
    }
  </script>
</div>
<!-- TradingView Widget END -->
</body>
</html>



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TradingView Widget with Price Level</title>
  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
</head>
<body>
<div id="tradingview-widget"></div>
<script type="text/javascript">
  // Установите уровень цены для линии
  const priceLevel = 100;

  // Создание виджета TradingView
  new TradingView.widget({
    "container_id": "tradingview-widget",
    "width": "100%",
    "height": "100%",
    "symbol": "NASDAQ:AAPL",
    "interval": "D",
    "timezone": "Etc/UTC",
    "theme": "light",
    "style": "1", // Свечной стиль графика
    "locale": "en",
    "toolbar_bg": "#f1f3f6",
    "enable_publishing": false,
    "hide_side_toolbar": false,
    "allow_symbol_change": true,
    "popup_width": "1000",
    "popup_height": "650",
    "studies": []
  });

  // Добавление горизонтальной линии после загрузки виджета
  function addHorizontalLine() {
    const widgetContainer = document.querySelector('#tradingview-widget iframe');
    const widgetIframeWindow = widgetContainer.contentWindow;

    widgetIframeWindow.TradingView.onready(function() {
      const chart = widgetIframeWindow.TradingView.chart();
      chart.createShape({
        type: 'hline',
        price: priceLevel,
        title: Level ${priceLevel},
        overrides: {
          linecolor: '#ff0000',
          linewidth: 2,
          linestyle: 0
        }
      }, true);
    });
  }

  // Проверка загрузки виджета и добавление линии
  window.addEventListener('message', function(event) {
    if (event.data.event === 'onload' && event.data.widget_id === 'tradingview-widget') {
      addHorizontalLine();
    }
  });
</script>
</body>
</html>
